<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en"
      th:with="active='inventory', pageTitle='Inventory & Allocation'"
      th:replace="~{layout :: layout(~{::main})}">

<main class="inventory-page">
<!--    <link rel="stylesheet" th:href="@{/css/inventory.css}"/>-->

    <section class="page-header">
        <h1>Inventory & Allocation</h1>
        <a class="btn btn-gradient" th:href="@{/admin/inventory/create}">+ New Inventory Record</a>
    </section>

    <section class="card table-card">
        <h2>HQ Inventory (Kho tổng)</h2>

        <table class="table">
            <thead>
            <tr>
                <th>Trim</th>
                <th>Vehicle</th>
                <th>Location</th>
                <th>Qty On Hand</th>
                <th>Last Update</th>
                <th>Actions</th>
            </tr>
            </thead>

            <tbody>
            <tr th:each="inv : ${hqInventories}">
                <td th:text="${inv.trim.trimName}"></td>
                <td th:text="${inv.trim.vehicle.modelName}"></td>
                <td>HQ</td>
                <td th:text="${inv.qtyOnHand}"></td>
                <td th:text="${#temporals.format(inv.updatedAt, 'yyyy-MM-dd HH:mm')}"></td>
                <td>
                    <a class="btn btn-outline"
                       th:href="@{'/admin/inventory/' + ${inv.id} + '/edit'}">Edit</a>

                    <a class="btn btn-outline-secondary"
                       th:href="@{'/admin/inventory/' + ${inv.id} + '/history'}">
                        <i class="fas fa-history"></i> History
                    </a>

                    <form th:action="@{'/admin/inventory/' + ${inv.id} + '/delete'}"
                          method="post"
                          style="display:inline"
                          onsubmit="return confirm('Delete this record?');">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                        <button class="btn btn-danger" type="submit">Delete</button>
                    </form>
                </td>
            </tr>

            <tr th:if="${#lists.isEmpty(hqInventories)}">
                <td colspan="6" style="text-align:center; opacity:0.7;">No HQ inventory records.</td>
            </tr>
            </tbody>
        </table>
    </section>

    <section class="card table-card">
        <h2>Branch Inventory (Kho chi nhánh)</h2>

        <table class="table">
            <thead>
            <tr>
                <th>Branch</th>
                <th>Dealer</th>
                <th>Trim</th>
                <th>Vehicle</th>
                <th>Qty On Hand</th>
                <th>Last Update</th>
                <th>Actions</th>
            </tr>
            </thead>

            <tbody>
            <tr th:each="inv : ${branchInventories}">
                <td th:text="${inv.branch.name}"></td>
                <td th:text="${inv.dealer.name}"></td>
                <td th:text="${inv.trim.trimName}"></td>
                <td th:text="${inv.trim.vehicle.modelName}"></td>
                <td th:text="${inv.qtyOnHand}"></td>
                <td th:text="${#temporals.format(inv.updatedAt, 'yyyy-MM-dd HH:mm')}"></td>

                <td>
                    <a class="btn btn-outline"
                       th:href="@{'/admin/inventory/' + ${inv.id} + '/edit'}">Edit</a>

                    <a class="btn btn-outline-secondary"
                       th:href="@{'/admin/inventory/' + ${inv.id} + '/history'}">
                        <i class="fas fa-history"></i> History
                    </a>

                    <form th:action="@{'/admin/inventory/' + ${inv.id} + '/delete'}"
                          method="post"
                          style="display:inline"
                          onsubmit="return confirm('Delete this record?');">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                        <button class="btn btn-danger" type="submit">Delete</button>
                    </form>
                </td>
            </tr>

            <tr th:if="${#lists.isEmpty(branchInventories)}">
                <td colspan="7" style="text-align:center; opacity:0.7;">No branch inventory records.</td>
            </tr>
            </tbody>
        </table>
    </section>
</main>
</html>
